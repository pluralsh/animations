---
import PluralLogomark from "../components/PluralLogomark.astro";
import SquareDeep from "../components/SquareDeep.astro";
import BigSquare from "../components/BigSquare.astro";
import SquareFlat from "../components/SquareFlat.astro";
import Layout from "../layouts/Layout.astro";
const svgWidth = 1080;
const svgHeight = 1080;
const squareWidth = 58;
const squareHeight = 58;
const gapX = 20;
const gapY = 20;
const xSpacing = squareWidth + gapX;
const ySpacing = squareHeight + gapY;
const bigSquareSize = 288;
const centerSquaresWidth = 3 * squareWidth + 2 * gapX;
const centerSquaresHeight = 3 * squareHeight + 2 * gapY;
const centerSquaresTop = (bigSquareSize - centerSquaresHeight) / 2;
const centerSquaresLeft = (bigSquareSize - centerSquaresWidth) / 2;
---

<Layout title="My animation">
  <link rel="stylesheet" href="/index.css" />

  <script src="../client/anim.ts"></script>
  <main>
    <h1>Welcome</h1>
    <div class="myAnimation" id="animation1">
      <div
        class="bigSquareArea"
        style={{ width: `${bigSquareSize}px`, height: `${bigSquareSize}px` }}
      >
        <div class="bigSquareContainer">
          <BigSquare class="bigSquare" style={{ zIndex: -1 }} />
          <div
            class="squares"
            style={{
              top: `${centerSquaresTop}px`,
              left: `${centerSquaresLeft}px`,
            }}
          >
            <div
              class:list={["middleSquare", "pluralLogo"]}
              style={{
                top: `${1 * ySpacing}px`,
                left: `${1 * xSpacing}px`,
              }}
            >
              <PluralLogomark />
            </div>
          </div>
        </div>
        <div
          class="squares"
          style={{
            top: `${centerSquaresTop}px`,
            left: `${centerSquaresLeft}px`,
          }}
        >
          {
            Array.from(Array(3)).map((_, j) => {
              const x = Array.from(Array(3)).map((_, i) => {
                const isCenter = i === 1 && j === 1;
                return (
                  <div
                    class:list={["middleSquare", "appSquare"]}
                    style={{
                      top: `${j * ySpacing}px`,
                      left: `${i * xSpacing}px`,
                      ...(isCenter ? { display: "none" } : {}),
                    }}
                  >
                    <div class="zTarget">
                      <div class:list={["shape"]}>
                        {isCenter ? null : <SquareDeep />}
                      </div>
                    </div>
                  </div>
                );
              });
              return <>{x}</>;
            })
          }
        </div>
      </div>
    </div>
  </main>
</Layout>
<script>
  const gradients = document.querySelectorAll(".rotateGradient");
</script>
<style lang="scss" define:vars={{ squareWidth: `${squareWidth}px` }}>
  .myAnimation {
    --moderateShadow: drop-shadow(0px 3px 6px rgba(14, 16, 21, 0.2)) drop-shadow(0px 10px 20px rgba(14, 16, 21, 0.3));
    * {
      transform-style: preserve-3d;
      transform-origin: 50% 50%;
    }
    transform-origin: 50% 50%;
    background-color: rgba(255, 0, 0, 0);
    width: 500px;
    height: 500px;
    background-color: "blue";
    position: relative;
    .bigSquareArea {
      position: absolute;
      left: 58px;
      top: -28px;
      transform: rotateX(57deg) rotateY(0) rotateZ(-45deg);
      transform-origin: 50% 50%;
    }
    .bigSquare {
      position: absolute;
      pointer-events: none;
      z-index: -1;
    }
    .squares {
      position: absolute;
    }
    .middleSquare {
      position: absolute;
      width: var(--squareWidth);
      height: var(--squareWidth);
      .shape {
        position: absolute;
        width: 100%;
        height: 100%;
        pointer-events: none;
        cursor: default;
        border-radius: 3px;
      }
      &.appSquare:hover {
        .shape {
          transform: translateZ(10px);
          transition: transform 0.1s ease-out;
          transform-origin: 50% 100%;
        }
      }
      .shadow {
        position: absolute;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
      }
    }

    .square {
      position: absolute;
      width: 30px;
      height: 30px;
      .shape {
        position: absolute;
        width: 100%;
        height: 100%;
        pointer-events: none;
        cursor: default;
        border-radius: 3px;
      }
      &:hover {
        .shape {
          transform: rotateX(0) rotateY(-10deg) rotateZ(0) translateZ(5px);
          transition: transform 0.1s ease-out;
          transform-origin: 50% 100%;
        }
      }
    }
  }
</style>
